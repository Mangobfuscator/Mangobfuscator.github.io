<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mangobfuscator</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&family=Roboto+Mono&display=swap" rel="stylesheet" />
  <style>
    body {
      background: #121212;
      color: #eee;
      font-family: 'Roboto Mono', monospace;
      margin: 0;
      padding: 2rem 3rem;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      user-select: none;
    }
    header, #mainUI { display: none; }
    #captcha-container {
      margin: auto;
      padding: 2rem;
      background: #222;
      border-radius: 16px;
      box-shadow: 0 0 25px #ff5722aa;
      max-width: 400px;
      text-align: center;
      color: #ff5722;
      font-family: 'Montserrat', sans-serif;
      font-weight: 700;
      font-size: 1.3rem;
      user-select: none;
    }
    .header-left {
      display: flex;
      align-items: center;
      gap: 1rem;
      flex-wrap: wrap;
      flex-grow: 1;
    }
    .title-logo {
      max-height: 45px;
      object-fit: contain;
      filter: drop-shadow(0 0 8px #ff5722);
      flex-shrink: 0;
      animation: pulseGlow 3s infinite alternate;
    }
    .header-text {
      font-family: 'Montserrat', sans-serif;
      font-weight: 600;
      font-size: 0.9rem;
      line-height: 1.3;
      color: #ff5722;
      text-shadow: 0 0 6px #ff5722;
      user-select: text;
      letter-spacing: 0.02em;
      max-width: 600px;
    }
    .discord-link {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      user-select: none;
      flex-shrink: 0;
    }
    .discord-link img {
      width: 28px;
      height: 28px;
      filter: invert(37%) sepia(82%) saturate(5711%) hue-rotate(10deg) brightness(100%) contrast(103%);
      transition: filter 0.3s ease;
    }
    .discord-link:hover img {
      filter: invert(60%) sepia(93%) saturate(7847%) hue-rotate(10deg) brightness(120%) contrast(115%);
    }
    .version-label {
      font-family: 'Montserrat', sans-serif;
      font-weight: 700;
      font-size: 0.9rem;
      color: #ff5722;
      text-shadow: 0 0 6px #ff5722;
      user-select: none;
      flex-shrink: 0;
      white-space: nowrap;
    }
    main {
      flex-grow: 1;
      max-width: 900px;
      margin: 0 auto;
      width: 100%;
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }
    label {
      font-weight: 700;
      font-size: 1.1rem;
      margin-bottom: 0.4rem;
      user-select: text;
      color: #ff7f50;
      text-shadow: 0 0 6px #ff7f50;
    }
    textarea {
      background: #1e1e1e;
      border: 2px solid #ff5722;
      color: #eee;
      font-family: 'Roboto Mono', monospace;
      font-size: 15px;
      resize: vertical;
      width: 100%;
      min-height: 220px;
      padding: 1rem 1.25rem;
      border-radius: 12px;
      outline-offset: 0;
      outline-color: #ff4500;
      transition: border-color 0.25s ease;
      box-shadow: 0 0 15px rgba(255,87,34,0.25);
    }
    textarea:focus {
      border-color: #ff6f00;
      box-shadow: 0 0 25px #ff6f00;
    }
    button {
      align-self: flex-end;
      background: linear-gradient(45deg, #ff5722, #ff3d00);
      color: white;
      border: none;
      padding: 1rem 2.5rem;
      cursor: pointer;
      font-weight: 900;
      font-size: 1.3rem;
      border-radius: 16px;
      margin-top: 0.5rem;
      transition: background-position 0.4s ease, box-shadow 0.3s ease;
      user-select: none;
      box-shadow: 0 4px 15px rgba(255, 87, 34, 0.5);
      background-size: 200% 200%;
      background-position: 0% 50%;
    }
    button:hover {
      background-position: 100% 50%;
      box-shadow: 0 0 30px #ff5722;
    }
    button:active {
      transform: scale(0.98);
      box-shadow: 0 0 15px #ff5722;
    }
    @keyframes pulseGlow {
      0% { filter: drop-shadow(0 0 8px #ff5722); }
      100% { filter: drop-shadow(0 0 20px #ffab40); }
    }
  </style>
</head>
<body>
<div id="captcha-container">
  <div
    class="turnstile"
    data-sitekey="0x4AAAAAABphVf8GHrrsvNjP"
    data-callback="captchaPassed"
  ></div>
</div>

<header>
  <div class="header-left">
    <img class="title-logo" src="https://media.discordapp.net/attachments/1228784805458739340/1403239261662216305/MANGOBFUSCATOR.png?format=webp" alt="Mango Obfuscator Title" />
    <div class="header-text">Mangobfuscator was founded and coded by vorp, aka 5_esx<br>Got tired of every obfuscator having a fucking gayass paywalls.</div>
  </div>
  <a href="https://discord.gg/z7VHvyRwfP" class="discord-link" target="_blank" rel="noopener noreferrer" aria-label="Join MangoLua Discord" title="Join MangoLua Discord">
    <img src="https://cdn-icons-png.flaticon.com/512/5968/5968756.png" alt="Discord" />
  </a>
  <div class="version-label">v1.3.7</div>
</header>

<main id="mainUI">
  <label for="inputLua">Paste your Lua code here:</label>
  <textarea id="inputLua" spellcheck="false" placeholder="-- Paste your Lua code here..."></textarea>

  <button id="btnObfuscate" disabled>Obfuscate</button>

  <label for="outputLua">Obfuscated Lua code:</label>
  <textarea id="outputLua" spellcheck="false" readonly placeholder="Obfuscated output appears here..."></textarea>
</main>

<script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
<script>
(() => {
  const mainUI = document.getElementById('mainUI')
  const captchaContainer = document.getElementById('captcha-container')
  const header = document.querySelector('header')
  const btnObfuscate = document.getElementById('btnObfuscate')
  const inputLua = document.getElementById('inputLua')
  const outputLua = document.getElementById('outputLua')

  window.captchaPassed = async function(token) {
    try {
      const res = await fetch('/api/verify', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ token })
      })
      const data = await res.json()
      if (data.success) {
        captchaContainer.style.display = 'none'
        mainUI.style.display = 'flex'
        header.style.display = 'flex'
        btnObfuscate.disabled = false
      } else {
        alert('Captcha verification failed. Try again.')
        window.turnstile.reset()
      }
    } catch {
      alert('Verification error. Try again later.')
      window.turnstile.reset()
    }
  }

  function obfuscateLua(code) {
    return code.split('').reverse().join('')
  }

  btnObfuscate.addEventListener('click', () => {
    const input = inputLua.value.trim()
    if (!input) {
      alert('Paste some Lua code first!')
      return
    }
    try {
      const output = obfuscateLua(input)
      outputLua.value = output
    } catch (e) {
      alert('Obfuscation failed: ' + e.message)
    }
  })
})()
</script>
</body>
</html>
